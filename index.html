<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Health Mate - Your Digital Healthcare Companion</title>

    <!-- Add this in your HTML head -->
    <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
    
    <!-- External Resources -->
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>
<body>

    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="logo">
                <i class="fas fa-heartbeat"></i>
                AI Health Mate
            </div>
            <ul class="nav-links">
                <li><a href="#" onclick="showSection('home'); return false;">Home</a></li>
                <li><a href="#" onclick="showSection('ai-chat'); return false;">AI Chat</a></li>
                <li><a href="#" onclick="showSection('video-call'); return false;">Video Call</a></li>
                <li><a href="#" onclick="showSection('doctor-login'); return false;" class="btn btn-outline">Doctor Login</a></li>
                <li><a href="#" onclick="showSection('patient-login'); return false;" class="btn btn-primary">Patient Login</a></li>
            </ul>
        </div>
    </nav>

    <!-- Home Section -->
    <section id="home" class="section active">
        <div class="hero">
            <div class="hero-content">
                <div class="hero-text">
                    <h1>Your AI-Powered Healthcare Companion</h1>
                    <p>Experience the future of healthcare with AI Health Mate. Get instant symptom analysis, connect with doctors via video calls, and manage your health journey seamlessly.</p>
                    <div class="hero-buttons">
                        <a href="#" onclick="showSection('ai-chat'); return false;" class="btn btn-primary">
                            <i class="fas fa-robot"></i> Try AI Chat
                        </a>
                        <a href="#" onclick="showSection('video-call'); return false;" class="btn btn-secondary">
                            <i class="fas fa-video"></i> Start Video Call
                        </a>
                    </div>
                </div>
                <div class="hero-image">
                    <i class="fas fa-user-md"></i>
                </div>
            </div>
        </div>

        <div class="features">
            <div class="container">
                <h2 style="text-align: center; margin-bottom: 3rem; font-size: 2.5rem;">Why Choose AI Health Mate?</h2>
                <div class="features-grid">
                    <div class="feature-card">
                        <div class="feature-icon">
                            <i class="fas fa-brain"></i>
                        </div>
                        <h3>AI Symptom Analysis</h3>
                        <p>Advanced AI algorithms analyze your symptoms and provide instant preliminary assessments to guide your healthcare decisions.</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">
                            <i class="fas fa-video"></i>
                        </div>
                        <h3>Video Consultations</h3>
                        <p>Connect with certified doctors through secure video calls from the comfort of your home, available 24/7.</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">
                            <i class="fas fa-prescription-bottle-alt"></i>
                        </div>
                        <h3>Smart Prescriptions</h3>
                        <p>Get AI-generated treatment suggestions reviewed and approved by licensed physicians with downloadable prescriptions.</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Contact Form -->
        <div class="container" style="margin-top: 4rem;">
            <h2 style="text-align: center; margin-bottom: 2rem;">Contact Us</h2>
            <div class="form-container">
                <form id="contactForm">
                    <div class="form-group">
                        <label for="name">Full Name</label>
                        <input type="text" id="name" name="name" required>
                    </div>
                    <div class="form-group">
                        <label for="email">Email Address</label>
                        <input type="email" id="email" name="email" required>
                    </div>
                    <div class="form-group">
                        <label for="message">Message</label>
                        <textarea id="message" name="message" rows="4" required></textarea>
                    </div>
                    <button type="submit" class="btn btn-primary" style="width: 100%;">
                        <i class="fas fa-paper-plane"></i> Send Message
                    </button>
                </form>
            </div>
        </div>
    </section>

    <!-- AI Chat Section -->
    <section id="ai-chat" class="section">
        <div class="container">
            <!-- Back Button -->
            <button class="back-button" onclick="handleBackButton(); return false;">
                <i class="fas fa-arrow-left"></i> Back
            </button>
            
            <h2 style="text-align: center; margin-bottom: 2rem;">
                <i class="fas fa-robot"></i> AI Medical Consultation
            </h2>
            
            <!-- Chat Status -->
            <div id="chatStatus" style="text-align: center; margin-bottom: 1rem; padding: 0.5rem; background: var(--bg-light); border-radius: 0.5rem;">
                <i class="fas fa-brain"></i> <span id="chatStatusText">Ready to start consultation</span>
            </div>
            
            <div class="chat-container">
                <div class="chat-header">
                    <i class="fas fa-robot"></i>
                    <div>
                        <h3>Dr. AI - Medical Assistant</h3>
                        <p style="opacity: 0.8; margin: 0;">Intelligent symptom analysis with follow-up questions</p>
                    </div>
                    <div style="margin-left: auto;">
                        <span id="sessionInfo" style="font-size: 0.8rem; opacity: 0.7;"></span>
                    </div>
                </div>
                
                <div class="chat-messages" id="chatMessages">
                    <div class="message ai">
                        <div class="message-content">
                            <p>Hello! I'm Dr. AI, your intelligent medical assistant. I'll help you analyze your symptoms by asking detailed questions, just like a real doctor would.</p>
                            <p><strong>How it works:</strong></p>
                            <ul style="margin: 0.5rem 0; padding-left: 1.5rem;">
                                <li>Describe your symptoms</li>
                                <li>I'll ask follow-up questions</li>
                                <li>After gathering enough information, I'll generate a treatment plan</li>
                                <li>A licensed doctor will review and approve the prescription</li>
                            </ul>
                            <p style="color: #f59e0b; margin-top: 1rem;"><i class="fas fa-exclamation-triangle"></i> <em>This is for preliminary assessment only and is not a substitute for professional medical advice.</em></p>
                        </div>
                    </div>
                </div>
                
                <div class="chat-input">
                    <div class="input-group">
                        <input type="text" id="symptomInput" placeholder="Describe your symptoms (e.g., 'I have a fever and headache')..." onkeypress="handleChatKeyPress(event)">
                        <button onclick="sendSymptomMessage()" class="btn btn-primary" id="sendBtn">
                            <i class="fas fa-paper-plane"></i>
                        </button>
                    </div>
                    <div style="margin-top: 0.5rem; font-size: 0.8rem; color: var(--text-light);">
                        <i class="fas fa-lightbulb"></i> Be specific about your symptoms, duration, and severity for better analysis
                    </div>
                </div>
            </div>
                        
            <!-- AI Features Info -->
            <div style="margin-top: 2rem; padding: 1.5rem; background: white; border-radius: 1rem; box-shadow: var(--shadow);">
                <h4><i class="fas fa-magic"></i> AI-Powered Features</h4>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem; margin-top: 1rem;">
                    <div style="padding: 1rem; background: var(--bg-light); border-radius: 0.5rem;">
                        <h5><i class="fas fa-comments"></i> Intelligent Follow-ups</h5>
                        <p style="margin: 0.5rem 0; font-size: 0.9rem;">AI asks relevant medical questions based on your symptoms</p>
                    </div>
                    <div style="padding: 1rem; background: var(--bg-light); border-radius: 0.5rem;">
                        <h5><i class="fas fa-prescription-bottle-alt"></i> Smart Prescriptions</h5>
                        <p style="margin: 0.5rem 0; font-size: 0.9rem;">Generates treatment plans reviewed by real doctors</p>
                    </div>
                    <div style="padding: 1rem; background: var(--bg-light); border-radius: 0.5rem;">
                        <h5><i class="fas fa-clock"></i> 24/7 Available</h5>
                        <p style="margin: 0.5rem 0; font-size: 0.9rem;">Get instant preliminary assessment anytime</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Video Call Section -->
    <section id="video-call" class="section">
        <div class="container">
            <!-- Back Button -->
            <button class="back-button" onclick="handleBackButton(); return false;">
                <i class="fas fa-arrow-left"></i> Back
            </button>
            
            <h2 style="text-align: center; margin-bottom: 2rem;">Video Consultation</h2>
            <div class="video-container">
                <h3>Connect with a Doctor</h3>
                <p>Start a secure video call with one of our certified physicians</p>
                
                <!-- Connection Status -->
                <div id="connectionStatus" style="text-align: center; margin: 1rem 0; padding: 0.5rem; background: var(--bg-light); border-radius: 0.5rem;">
                    <i class="fas fa-wifi"></i> Disconnected
                </div>
                
                <div class="video-grid" id="videoGrid">
                    <!-- Local Video -->
                    <div style="position: relative;">
                        <div class="video-placeholder" id="localVideoPlaceholder">
                            <i class="fas fa-user"></i>
                            <p>Your Video</p>
                            <small>Camera access required</small>
                        </div>
                        <video id="localVideo" autoplay muted style="display: none; width: 100%; height: 300px; border-radius: 1rem; background: black;"></video>
                    </div>
                    
                    <!-- Remote Video -->
                    <div style="position: relative;">
                        <div class="video-placeholder" id="remoteVideoPlaceholder">
                            <i class="fas fa-user-md"></i>
                            <p>Doctor's Video</p>
                            <small>Waiting for connection</small>
                        </div>
                        <video id="remoteVideo" autoplay style="display: none; width: 100%; height: 300px; border-radius: 1rem; background: black;"></video>
                    </div>
                </div>

                <div class="video-controls">
                    <button id="startCallBtn" onclick="startVideoCall()" class="btn btn-primary">
                        <i class="fas fa-video"></i> Start Call
                    </button>
                    <button id="endCallBtn" onclick="endVideoCall()" class="btn" style="background: var(--danger-color); color: white; display: none;">
                        <i class="fas fa-phone-slash"></i> End Call
                    </button>
                    <button id="muteBtn" onclick="toggleMute()" class="btn btn-outline" style="display: none;">
                        <i class="fas fa-microphone"></i> Mute
                    </button>
                    <button id="cameraBtn" onclick="toggleCamera()" class="btn btn-outline" style="display: none;">
                        <i class="fas fa-video"></i> Camera
                    </button>
                </div>
                
                <!-- Online Doctors (for patients) -->
                <div id="onlineDoctorsContainer" style="margin-top: 2rem; padding: 1rem; background: var(--bg-light); border-radius: 0.5rem;">
                    <h4><i class="fas fa-user-md"></i> Available Doctors</h4>
                    <p style="color: var(--text-light);">Loading...</p>
                </div>
                
                <div style="margin-top: 2rem; padding: 1rem; background: var(--bg-light); border-radius: 0.5rem;">
                    <h4><i class="fas fa-info-circle"></i> Video Call Features</h4>
                    <ul style="margin: 1rem 0; padding-left: 2rem;">
                        <li>HD video and audio quality</li>
                        <li>Secure encrypted connection</li>
                        <li>Real-time communication</li>
                        <li>Professional healthcare consultation</li>
                    </ul>
                </div>
            </div>
        </div>
    </section>

    <!-- Doctor Login Section -->
    <section id="doctor-login" class="section">
        <div class="container">
            <!-- Back Button -->
            <button class="back-button" onclick="handleBackButton(); return false;">
                <i class="fas fa-arrow-left"></i> Back
            </button>
            
            <h2 style="text-align: center; margin-bottom: 2rem;">Doctor Portal</h2>
            <div class="form-container">
                <div style="text-align: center; margin-bottom: 2rem;">
                    <i class="fas fa-user-md" style="font-size: 4rem; color: var(--primary-color);"></i>
                </div>
                <form id="doctorLoginForm" onsubmit="handleDoctorLogin(event)">
                    <div class="form-group">
                        <label for="doctorEmail">Medical License ID / Email</label>
                        <input type="text" id="doctorEmail" name="doctorEmail" required>
                    </div>
                    <div class="form-group">
                        <label for="doctorPassword">Password</label>
                        <input type="password" id="doctorPassword" name="doctorPassword" required>
                    </div>
                    <div class="form-group">
                        <label for="specialty">Specialty</label>
                        <select id="specialty" name="specialty">
                            <option value="general">General Medicine</option>
                            <option value="cardiology">Cardiology</option>
                            <option value="dermatology">Dermatology</option>
                            <option value="pediatrics">Pediatrics</option>
                            <option value="psychiatry">Psychiatry</option>
                        </select>
                    </div>
                    <button type="submit" class="btn btn-primary" style="width: 100%; margin-bottom: 1rem;">
                        <i class="fas fa-sign-in-alt"></i> Login as Doctor
                    </button>
                </form>
                <p style="text-align: center;">
                    <a href="#" onclick="showDoctorSignup(); return false;" style="color: var(--primary-color); cursor: pointer;">Don't have an account? Sign up here</a>
                </p>
            </div>
        </div>
    </section>

    <!-- Patient Login Section -->
    <section id="patient-login" class="section">
        <div class="container">
            <!-- Back Button -->
            <button class="back-button" onclick="handleBackButton(); return false;">
                <i class="fas fa-arrow-left"></i> Back
            </button>
            
            <h2 style="text-align: center; margin-bottom: 2rem;">Patient Portal</h2>
            <div class="form-container">
                <div style="text-align: center; margin-bottom: 2rem;">
                    <i class="fas fa-user" style="font-size: 4rem; color: var(--primary-color);"></i>
                </div>
                <form id="patientLoginForm" onsubmit="handlePatientLogin(event)">
                    <div class="form-group">
                        <label for="patientEmail">Email Address</label>
                        <input type="email" id="patientEmail" name="patientEmail" required>
                    </div>
                    <div class="form-group">
                        <label for="patientPassword">Password</label>
                        <input type="password" id="patientPassword" name="patientPassword" required>
                    </div>
                    <button type="submit" class="btn btn-primary" style="width: 100%; margin-bottom: 1rem;">
                        <i class="fas fa-sign-in-alt"></i> Login as Patient
                    </button>
                </form>
                <p style="text-align: center;">
                    <a href="#" onclick="showPatientSignup(); return false;" style="color: var(--primary-color); cursor: pointer;">New to AI Health Mate? Sign up here</a>
                </p>
            </div>
        </div>
    </section>

    <!-- Patient Signup Section -->
    <section id="patient-signup" class="section">
        <div class="container">
            <!-- Back Button -->
            <button class="back-button" onclick="handleBackButton(); return false;">
                <i class="fas fa-arrow-left"></i> Back
            </button>
            
            <h2 style="text-align: center; margin-bottom: 2rem;">Patient Signup</h2>
            <div class="form-container">
                <form id="patientSignupForm" onsubmit="handlePatientSignup(event)">
                    <div class="form-group">
                        <label for="signupName">Full Name</label>
                        <input type="text" id="signupName" name="signupName" required>
                    </div>
                    <div class="form-group">
                        <label for="signupEmail">Email</label>
                        <input type="email" id="signupEmail" name="signupEmail" required>
                    </div>
                    <div class="form-group">
                        <label for="signupPhone">Phone</label>
                        <input type="text" id="signupPhone" name="signupPhone" required>
                    </div>
                    <div class="form-group">
                        <label for="signupAge">Age</label>
                        <input type="number" id="signupAge" name="signupAge" required>
                    </div>
                    <div class="form-group">
                        <label for="signupPassword">Password</label>
                        <input type="password" id="signupPassword" name="signupPassword" required>
                    </div>
                    <button type="submit" class="btn btn-primary" style="width: 100%;">
                        <i class="fas fa-user-plus"></i> Create Account
                    </button>
                </form>
                <p style="text-align: center; margin-top: 1rem;">
                    <a href="#" onclick="showSection('patient-login'); return false;" style="color: var(--primary-color); cursor: pointer;">
                        Already have an account? Login here
                    </a>
                </p>
            </div>
        </div>
    </section>

    <!-- Doctor Signup Section -->
    <section id="doctor-signup" class="section">
        <div class="container">
            <!-- Back Button -->
            <button class="back-button" onclick="handleBackButton(); return false;">
                <i class="fas fa-arrow-left"></i> Back
            </button>
            
            <h2 style="text-align: center; margin-bottom: 2rem;">Doctor Signup</h2>
            <div class="form-container">
                <div style="text-align: center; margin-bottom: 2rem;">
                    <i class="fas fa-user-md" style="font-size: 4rem; color: var(--primary-color);"></i>
                </div>
                <form id="doctorSignupForm" onsubmit="handleDoctorSignup(event)">
                    <div class="form-group">
                        <label for="doctorSignupName">Full Name</label>
                        <input type="text" id="doctorSignupName" name="doctorSignupName" required>
                    </div>
                    <div class="form-group">
                        <label for="doctorSignupEmail">Email</label>
                        <input type="email" id="doctorSignupEmail" name="doctorSignupEmail" required>
                    </div>
                    <div class="form-group">
                        <label for="doctorSignupLicense">Medical License ID</label>
                        <input type="text" id="doctorSignupLicense" name="doctorSignupLicense" required>
                    </div>
                    <div class="form-group">
                        <label for="doctorSignupSpecialty">Specialty</label>
                        <select id="doctorSignupSpecialty" name="doctorSignupSpecialty" required>
                            <option value="">Select Specialty</option>
                            <option value="general">General Medicine</option>
                            <option value="cardiology">Cardiology</option>
                            <option value="dermatology">Dermatology</option>
                            <option value="pediatrics">Pediatrics</option>
                            <option value="psychiatry">Psychiatry</option>
                            <option value="orthopedics">Orthopedics</option>
                            <option value="neurology">Neurology</option>
                            <option value="gynecology">Gynecology</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="doctorSignupPassword">Password</label>
                        <input type="password" id="doctorSignupPassword" name="doctorSignupPassword" required>
                    </div>
                    <button type="submit" class="btn btn-primary" style="width: 100%;">
                        <i class="fas fa-user-plus"></i> Create Doctor Account
                    </button>
                </form>
                <p style="text-align: center; margin-top: 1rem;">
                    <a href="#" onclick="showSection('doctor-login'); return false;" style="color: var(--primary-color); cursor: pointer;">
                        Already have an account? Login here
                    </a>
                </p>
            </div>
        </div>
    </section>

    <!-- Patient Dashboard -->
    <section id="patient-dashboard" class="section">
        <div class="container">
            <!-- Back Button -->
            <button class="back-button" onclick="handleBackButton(); return false;">
                <i class="fas fa-arrow-left"></i> Back
            </button>
            
            <h2>Welcome Back, <span id="patientName">Patient</span>!</h2>
            <p style="color: var(--text-light); margin-bottom: 3rem;">Your AI-powered health companion</p>
            
            <div class="dashboard-grid">
                <div class="dashboard-card">
                    <h3><i class="fas fa-chart-line"></i> Health Overview</h3>
                    <div class="stats">
                        <div class="stat">
                            <div class="stat-number">12</div>
                            <div>Consultations</div>
                        </div>
                        <div class="stat">
                            <div class="stat-number" id="aiConsultationsCount">8</div>
                            <div>AI Consultations</div>
                        </div>
                        <div class="stat">
                            <div class="stat-number">5</div>
                            <div>Prescriptions</div>
                        </div>
                    </div>
                </div>
                
                <div class="dashboard-card">
                    <h3><i class="fas fa-robot"></i> AI Health Assistant</h3>
                    <div style="margin: 1rem 0;">
                        <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem;">
                            <div style="width: 8px; height: 8px; background: var(--secondary-color); border-radius: 50%;"></div>
                            <span style="font-size: 0.9rem;">24/7 Available</span>
                        </div>
                        <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 1rem;">
                            <div style="width: 8px; height: 8px; background: var(--primary-color); border-radius: 50%;"></div>
                            <span style="font-size: 0.9rem;">Instant Analysis</span>
                        </div>
                    </div>
                    <button onclick="showSection('ai-chat')" class="btn btn-primary" style="width: 100%;">
                        <i class="fas fa-robot"></i> Start AI Consultation
                    </button>
                </div>
                
                <div class="dashboard-card">
                    <h3><i class="fas fa-calendar-alt"></i> Quick Actions</h3>
                    <div style="display: flex; flex-direction: column; gap: 1rem;">
                        <button onclick="showSection('video-call')" class="btn btn-secondary">
                            <i class="fas fa-video"></i> Video Consultation
                        </button>
                        <button onclick="viewPrescriptions()" class="btn btn-outline">
                            <i class="fas fa-prescription-bottle-alt"></i> My Prescriptions
                        </button>
                    </div>
                </div>
            </div>

            <!-- Online Doctors Section -->
            <div id="onlineDoctorsContainer" style="margin-top: 3rem;">
                <h4><i class="fas fa-user-md"></i> Available Doctors (0)</h4>
                <p style="color: var(--text-light); margin: 1rem 0;">Loading available doctors...</p>
            </div>

            <!-- AI Consultation History -->
            <div style="margin-top: 3rem;">
                <h3><i class="fas fa-history"></i> Recent AI Consultations</h3>
                <div style="background: white; border-radius: 1rem; padding: 1.5rem; box-shadow: var(--shadow); margin-top: 1rem;">
                    <div class="activity-item" style="padding: 1rem 0; border-bottom: 1px solid var(--border-color);">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <strong><i class="fas fa-robot"></i> AI Consultation - Fever Symptoms</strong>
                                <p style="color: var(--text-light); margin: 0.25rem 0;">Prescription approved by Dr. Johnson</p>
                            </div>
                            <small style="color: var(--text-light);">2 hours ago</small>
                        </div>
                    </div>
                    <div class="activity-item" style="padding: 1rem 0; border-bottom: 1px solid var(--border-color);">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <strong><i class="fas fa-robot"></i> AI Consultation - Headache Analysis</strong>
                                <p style="color: var(--text-light); margin: 0.25rem 0;">Prescription under review</p>
                            </div>
                            <small style="color: var(--text-light);">5 hours ago</small>
                        </div>
                    </div>
                    <div class="activity-item" style="padding: 1rem 0;">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <strong><i class="fas fa-video"></i> Video Consultation</strong>
                                <p style="color: var(--text-light); margin: 0.25rem 0;">Consultation with Dr. Smith</p>
                            </div>
                            <small style="color: var(--text-light);">1 day ago</small>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Prescriptions View -->
            <div id="prescriptionsView" style="display: none; margin-top: 3rem;">
                <h3><i class="fas fa-prescription-bottle-alt"></i> Your Prescriptions</h3>
                
                <!-- Sample AI-generated prescription -->
                <div class="prescription-card" style="margin-top: 1rem;">
                    <div class="prescription-header">
                        <h4>AI Prescription #AI001</h4>
                        <small>Dr. AI Analysis | Approved by Dr. Johnson | Today</small>
                    </div>
                    <div class="prescription-content">
                        <p><strong>Symptoms Analyzed:</strong> Fever (101Â°F), headache, body aches lasting 2 days</p>
                        <p><strong>AI Diagnosis:</strong> Viral fever with associated symptoms</p>
                        <p><strong>Treatment Plan:</strong></p>
                        <ul class="medication-list">
                            <li><strong>Paracetamol 650mg</strong> - Every 6 hours for fever and pain</li>
                            <li><strong>Rest</strong> - Complete bed rest for 3-4 days</li>
                            <li><strong>Hydration</strong> - Increase fluid intake (water, ORS)</li>
                            <li><strong>Monitor</strong> - Check temperature regularly, consult if fever persists >3 days</li>
                        </ul>
                        <div style="background: var(--bg-light); padding: 1rem; border-radius: 0.5rem; margin: 1rem 0;">
                            <p style="margin: 0; font-size: 0.9rem; color: var(--text-dark);">
                                <i class="fas fa-info-circle"></i> 
                                <strong>AI Analysis:</strong> This prescription was generated by AI based on your symptoms 
                                and reviewed by Dr. Johnson for accuracy and safety.
                            </p>
                        </div>
                        <button onclick="downloadPrescription('AI001')" class="btn btn-primary">
                            <i class="fas fa-download"></i> Download PDF
                        </button>
                    </div>
                </div>

                <!-- Traditional prescription -->
                <div class="prescription-card" style="margin-top: 1rem;">
                    <div class="prescription-header">
                        <h4>Prescription #002</h4>
                        <small>Dr. Smith | Video Consultation | January 20, 2025</small>
                    </div>
                    <div class="prescription-content">
                        <p><strong>Diagnosis:</strong> Common Cold</p>
                        <ul class="medication-list">
                            <li>Paracetamol 500mg - Every 6 hours</li>
                            <li>Rest for 2-3 days</li>
                            <li>Increase fluid intake</li>
                        </ul>
                        <button onclick="downloadPrescription('002')" class="btn btn-outline">
                            <i class="fas fa-download"></i> Download PDF
                        </button>
                    </div>
                </div>
            </div>

            <!-- Logout Button -->
            <div style="margin-top: 3rem; text-align: center;">
                <button onclick="logout()" class="btn btn-outline">
                    <i class="fas fa-sign-out-alt"></i> Logout
                </button>
            </div>
        </div>
    </section>

    <!-- Doctor Dashboard -->
    <section id="doctor-dashboard" class="section">
        <div class="container">
            <!-- Back Button -->
            <button class="back-button" onclick="handleBackButton(); return false;">
                <i class="fas fa-arrow-left"></i> Back
            </button>
            
            <h2>Doctor Dashboard - <span id="doctorName">Dr. Smith</span></h2>
            <p style="color: var(--text-light); margin-bottom: 3rem;">Manage patients and approve AI-generated prescriptions</p>
            
            <div class="dashboard-grid">
                <div class="dashboard-card">
                    <h3><i class="fas fa-users"></i> Today's Overview</h3>
                    <div class="stats">
                        <div class="stat">
                            <div class="stat-number">8</div>
                            <div>Appointments</div>
                        </div>
                        <div class="stat">
                            <div class="stat-number" id="pendingPrescriptionsCount">3</div>
                            <div>Pending AI Reviews</div>
                        </div>
                        <div class="stat">
                            <div class="stat-number">12</div>
                            <div>Patients Today</div>
                        </div>
                    </div>
                </div>
                
                <div class="dashboard-card">
                    <h3><i class="fas fa-brain"></i> AI Integration Status</h3>
                    <div style="display: flex; align-items: center; gap: 1rem; margin: 1rem 0;">
                        <div style="width: 12px; height: 12px; background: var(--secondary-color); border-radius: 50%;"></div>
                        <span>AI Assistant Active</span>
                    </div>
                    <div style="background: var(--bg-light); padding: 1rem; border-radius: 0.5rem; margin: 1rem 0;">
                        <p style="margin: 0; font-size: 0.9rem; color: var(--text-light);">
                            <i class="fas fa-info-circle"></i> AI consultations require your approval before prescriptions are issued
                        </p>
                    </div>
                </div>
                
                <div class="dashboard-card">
                    <h3><i class="fas fa-clock"></i> Status</h3>
                    <div style="display: flex; align-items: center; gap: 1rem; margin: 1rem 0;">
                        <div style="width: 12px; height: 12px; background: var(--secondary-color); border-radius: 50%;"></div>
                        <span>Online - Available</span>
                    </div>
                    <button onclick="toggleDoctorStatus()" class="btn btn-outline" style="width: 100%;">
                        <i class="fas fa-power-off"></i> Go Offline
                    </button>
                </div>
            </div>

            <!-- Waiting Patients Section -->
            <div id="waitingPatientsContainer" style="margin-top: 3rem; padding: 1.5rem; background: white; border-radius: 1rem; box-shadow: var(--shadow);">
                <h4><i class="fas fa-clock"></i> Waiting Patients (0)</h4>
                <p style="color: var(--text-light); margin: 1rem 0;">No patients currently waiting for consultation.</p>
            </div>

            <!-- AI Prescription Approvals Section -->
            <div id="prescriptionApprovalsSection" style="margin-top: 3rem;">
                <h3><i class="fas fa-robot"></i> AI-Generated Prescriptions Requiring Approval</h3>
                <div style="background: var(--bg-light); padding: 1rem; border-radius: 0.5rem; margin-bottom: 1.5rem;">
                    <p style="margin: 0; color: var(--text-dark);">
                        <i class="fas fa-info-circle"></i> 
                        <strong>How it works:</strong> AI analyzes patient symptoms and generates treatment recommendations. 
                        You review, modify if needed, and approve or reject each prescription.
                    </p>
                </div>
                
                <div id="pendingPrescriptionsContainer">
                    <!-- AI-generated prescriptions will be dynamically added here -->
                    <div class="prescription-card" style="margin-bottom: 1rem;">
                        <div class="prescription-header">
                            <h4>No Pending AI Prescriptions</h4>
                            <small>AI-generated prescriptions will appear here for your review</small>
                        </div>
                        <div class="prescription-content">
                            <p style="color: var(--text-light);">
                                <i class="fas fa-clipboard-list"></i> When patients complete AI consultations, 
                                their treatment plans will be sent here for your professional review and approval.
                            </p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Quick Actions -->
            <div style="margin-top: 3rem;">
                <h3><i class="fas fa-bolt"></i> Quick Actions</h3>
                <div class="dashboard-grid" style="margin-top: 1.5rem;">
                    <div class="dashboard-card">
                        <h4><i class="fas fa-video"></i> Video Consultations</h4>
                        <p style="color: var(--text-light); margin: 1rem 0;">Connect with patients via secure video calls</p>
                        <button onclick="showSection('video-call')" class="btn btn-primary" style="width: 100%;">
                            <i class="fas fa-video"></i> Start Video Call
                        </button>
                    </div>
                    
                    <div class="dashboard-card">
                        <h4><i class="fas fa-chart-bar"></i> AI Analytics</h4>
                        <p style="color: var(--text-light); margin: 1rem 0;">View AI consultation statistics and accuracy</p>
                        <button onclick="viewAIAnalytics()" class="btn btn-outline" style="width: 100%;">
                            <i class="fas fa-chart-line"></i> View Analytics
                        </button>
                    </div>
                    
                    <div class="dashboard-card">
                        <h4><i class="fas fa-cog"></i> AI Settings</h4>
                        <p style="color: var(--text-light); margin: 1rem 0;">Configure AI consultation preferences</p>
                        <button onclick="configureAI()" class="btn btn-outline" style="width: 100%;">
                            <i class="fas fa-cog"></i> Configure
                        </button>
                    </div>
                </div>
            </div>

            <!-- Doctor Analytics with AI Metrics -->
            <div style="margin-top: 3rem;">
                <h3><i class="fas fa-chart-line"></i> Performance Analytics</h3>
                <div class="dashboard-grid" style="margin-top: 1.5rem;">
                    <div class="dashboard-card">
                        <h5><i class="fas fa-star"></i> Patient Satisfaction</h5>
                        <div class="stat-number" style="color: var(--secondary-color); font-size: 2.5rem;">4.9/5</div>
                        <p style="color: var(--text-light); margin: 0.5rem 0;">Based on 89 reviews</p>
                    </div>
                    
                    <div class="dashboard-card">
                        <h5><i class="fas fa-robot"></i> AI Accuracy</h5>
                        <div class="stat-number" style="color: var(--primary-color); font-size: 2.5rem;">94%</div>
                        <p style="color: var(--text-light); margin: 0.5rem 0;">AI prescriptions approved</p>
                    </div>
                    
                    <div class="dashboard-card">
                        <h5><i class="fas fa-clock"></i> Avg Review Time</h5>
                        <div class="stat-number" style="color: var(--accent-color); font-size: 2.5rem;">2.1min</div>
                        <p style="color: var(--text-light); margin: 0.5rem 0;">Per AI prescription review</p>
                    </div>
                </div>
            </div>

            <!-- Logout Button -->
            <div style="margin-top: 3rem; text-align: center;">
                <button onclick="logout()" class="btn btn-outline">
                    <i class="fas fa-sign-out-alt"></i> Logout
                </button>
            </div>
        </div>
    </section>

    <!-- Prescription Edit Modal (for doctors) -->
    <div id="prescriptionEditModal" class="prescription-edit-modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Modify AI-Generated Prescription</h3>
                <button onclick="closePrescriptionModal()" class="close-btn">&times;</button>
            </div>
            <div class="modal-body">
                <div style="margin-bottom: 1rem;">
                    <label style="font-weight: bold; color: var(--text-dark);">Patient Information:</label>
                    <div id="modalPatientInfo" style="background: var(--bg-light); padding: 1rem; border-radius: 0.5rem; margin-top: 0.5rem;"></div>
                </div>
                <div style="margin-bottom: 1rem;">
                    <label style="font-weight: bold; color: var(--text-dark);">AI Consultation Summary:</label>
                    <div id="modalConsultationSummary" style="background: var(--bg-light); padding: 1rem; border-radius: 0.5rem; margin-top: 0.5rem; max-height: 150px; overflow-y: auto;"></div>
                </div>
                <div>
                    <label for="prescriptionEdit" style="font-weight: bold; color: var(--text-dark);">Prescription Content:</label>
                    <textarea id="prescriptionEdit" rows="12" style="width: 100%; margin-top: 0.5rem; padding: 1rem; border: 2px solid var(--border-color); border-radius: 0.5rem; font-family: inherit;" placeholder="Edit the prescription content..."></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button onclick="savePrescriptionModification()" class="btn btn-primary">
                    <i class="fas fa-check"></i> Approve with Changes
                </button>
                <button onclick="closePrescriptionModal()" class="btn btn-outline">
                    <i class="fas fa-times"></i> Cancel
                </button>
            </div>
        </div>
    </div>

    <!-- Dark Mode Toggle -->
    <button class="dark-mode-toggle" onclick="toggleDarkMode()" id="darkModeBtn">
        <i class="fas fa-moon"></i>
    </button>

    <!-- Notification Container -->
    <div id="notification" class="notification"></div>

    <!-- Load Script at the end -->
    <script src="script.js"></script>

    <script>
        // Backup navigation function in case script.js fails to load
        window.handleBackButton = function() {
            console.log('Backup back button called');
            
            const currentSection = document.querySelector('.section.active')?.id || 'home';
            console.log('Current section:', currentSection);
            
            let targetSection = 'home';
            
            // Simple logic for back navigation
            switch(currentSection) {
                case 'ai-chat':
                case 'video-call':
                    // Check if user is logged in by looking for user data in forms
                    const patientName = document.getElementById('patientName');
                    const doctorName = document.getElementById('doctorName');
                    
                    if (patientName && patientName.textContent !== 'Patient') {
                        targetSection = 'patient-dashboard';
                    } else if (doctorName && doctorName.textContent !== 'Dr. Smith') {
                        targetSection = 'doctor-dashboard';
                    } else {
                        targetSection = 'home';
                    }
                    break;
                    
                case 'patient-dashboard':
                case 'doctor-dashboard':
                    targetSection = 'home';
                    break;
                    
                case 'patient-signup':
                    targetSection = 'patient-login';
                    break;
                    
                case 'doctor-signup':
                    targetSection = 'doctor-login';
                    break;
                    
                default:
                    targetSection = 'home';
                    break;
            }
            
            console.log('Navigating to:', targetSection);
            
            // Hide all sections
            document.querySelectorAll('.section').forEach(sec => sec.classList.remove('active'));
            
            // Show target section
            const target = document.getElementById(targetSection);
            if (target) {
                target.classList.add('active');
                window.scrollTo({ top: 0, behavior: 'smooth' });
                console.log('Navigation successful to:', targetSection);
            } else {
                console.error('Target section not found:', targetSection);
                // Fallback to home
                const home = document.getElementById('home');
                if (home) {
                    home.classList.add('active');
                }
            }
        };

        // Alternative simple showSection function
        window.showSection = window.showSection || function(sectionId) {
            console.log('Simple showSection called for:', sectionId);
            
            document.querySelectorAll('.section').forEach(sec => sec.classList.remove('active'));
            
            const targetSection = document.getElementById(sectionId);
            if (targetSection) {
                targetSection.classList.add('active');
                window.scrollTo({ top: 0, behavior: 'smooth' });
                console.log('Section activated:', sectionId);
            } else {
                console.error('Section not found:', sectionId);
            }
        };

        console.log('Backup navigation functions loaded');
    </script>

    <style>
    /* Additional CSS for AI features */
    .prescription-edit-modal {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.8);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 10000;
    }

    .modal-content {
        background: white;
        border-radius: 1rem;
        max-width: 800px;
        width: 90%;
        max-height: 90vh;
        overflow-y: auto;
        box-shadow: var(--shadow-lg);
    }

    .modal-header {
        padding: 1.5rem;
        border-bottom: 1px solid var(--border-color);
        display: flex;
        justifyDiego-content: space-between;
        align-items: center;
    }

    .modal-body {
        padding: 1.5rem;
    }

    .modal-footer {
        padding: 1.5rem;
        border-top: 1px solid var(--border-color);
        display: flex;
        gap: 1rem;
        justify-content: flex-end;
    }

    .close-btn {
        background: none;
        border: none;
        font-size: 1.5rem;
        cursor: pointer;
        color: var(--text-light);
    }

    .close-btn:hover {
        color: var(--text-dark);
    }

    .typing-dots {
        animation: typing 1.5s infinite;
    }

    @keyframes typing {
        0%, 20% { content: ''; }
        40% { content: '.'; }
        60% { content: '..'; }
        80%, 100% { content: '...'; }
    }

    .chat-status {
        display: inline-block;
        padding: 0.5rem 1rem;
        border-radius: 0.5rem;
        font-size: 0.9rem;
        font-weight: 500;
    }

    .chat-status.active {
        background: var(--secondary-color);
        color: white;
    }

    .chat-status.processing {
        background: var(--accent-color);
        color: white;
    }

    .chat-status.ready {
        background: var(--bg-light);
        color: var(--text-dark);
    }

    .prescription-approved {
        background: var(--bg-light);
        border: 2px solid var(--secondary-color);
        border-radius: 0.5rem;
        padding: 1rem;
        margin: 0.5rem 0;
    }

    .prescription-approved h4 {
        color: var(--secondary-color);
        margin-bottom: 0.5rem;
    }

    .approval-status {
        position: absolute;
        top: 10px;
        right: 10px;
        background: var(--secondary-color);
        color: white;
        padding: 0.25rem 0.5rem;
        border-radius: 0.25rem;
        font-size: 0.8rem;
        font-weight: bold;
    }

    /* Responsive adjustments */
    @media (max-width: 768px) {
        .modal-content {
            width: 95%;
            margin: 1rem;
        }
        
        .modal-footer {
            flex-direction: column;
        }
        
        .modal-footer button {
            width: 100%;
        }
    }
    </style>

</body>
</html>
